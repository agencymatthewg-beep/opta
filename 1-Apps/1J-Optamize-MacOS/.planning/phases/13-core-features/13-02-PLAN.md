# Plan 13-02: Communication Style Preference

wave: 1
autonomous: true

## Overview

Add user preference for communication style: "Informative & Educational" vs "Concise & Efficient". This affects explanation lengths throughout the app.

## Tasks

### 1. Add Communication Style to User Preferences
**File**: `src/types/preferences.ts` (new or extend existing)

```tsx
export type CommunicationStyle = 'informative' | 'concise';

export interface UserPreferences {
  // ... existing
  communicationStyle: CommunicationStyle;
}
```

### 2. Create Communication Style Context
**File**: `src/components/CommunicationStyleContext.tsx` (new)

```tsx
interface CommunicationStyleContextType {
  style: CommunicationStyle;
  setStyle: (style: CommunicationStyle) => void;
  isVerbose: boolean;  // Helper for components
}

export function CommunicationStyleProvider({ children }) {
  const [style, setStyle] = useState<CommunicationStyle>(() => {
    const saved = localStorage.getItem('opta-communication-style');
    return (saved as CommunicationStyle) || 'informative';
  });

  useEffect(() => {
    localStorage.setItem('opta-communication-style', style);
  }, [style]);

  return (
    <CommunicationStyleContext.Provider value={{
      style,
      setStyle,
      isVerbose: style === 'informative',
    }}>
      {children}
    </CommunicationStyleContext.Provider>
  );
}
```

### 3. Add Setting to Settings Page
**File**: `src/pages/Settings.tsx`

Add toggle in Preferences section:

```tsx
<div className="space-y-4">
  <h3 className="text-lg font-medium">Communication Style</h3>
  <div className="grid grid-cols-2 gap-4">
    <button
      onClick={() => setCommunicationStyle('informative')}
      className={cn(
        "glass-subtle rounded-lg p-4 text-left transition-all",
        style === 'informative' && "ring-2 ring-primary"
      )}
    >
      <BookOpen className="w-5 h-5 mb-2 text-primary" />
      <p className="font-medium">Informative & Educational</p>
      <p className="text-sm text-muted-foreground">
        Explains the "why" behind optimizations
      </p>
    </button>

    <button
      onClick={() => setCommunicationStyle('concise')}
      className={cn(
        "glass-subtle rounded-lg p-4 text-left transition-all",
        style === 'concise' && "ring-2 ring-primary"
      )}
    >
      <Zap className="w-5 h-5 mb-2 text-primary" />
      <p className="font-medium">Concise & Efficient</p>
      <p className="text-sm text-muted-foreground">
        Just the facts, minimal explanation
      </p>
    </button>
  </div>
</div>
```

### 4. Adapt Learn Mode Explanations
**File**: `src/components/LearnModeExplanation.tsx`

Adjust explanation depth based on style:

```tsx
export function LearnModeExplanation({ topic, shortExplanation, fullExplanation }) {
  const { isVerbose } = useCommunicationStyle();
  const { learnModeEnabled } = useLearnMode();

  if (!learnModeEnabled) return null;

  return (
    <motion.div className="glass-subtle rounded-lg p-3 mt-2">
      <p className="text-sm">
        {isVerbose ? fullExplanation : shortExplanation}
      </p>
      {!isVerbose && (
        <button className="text-xs text-primary hover:underline">
          Learn more...
        </button>
      )}
    </motion.div>
  );
}
```

### 5. Update Chat System Prompt
**File**: `src/hooks/useChat.ts` or equivalent

Adjust LLM system prompt based on style:

```tsx
const getSystemPrompt = () => {
  const { style } = useCommunicationStyle();

  const basePrompt = "You are Opta, a PC optimization expert...";

  const styleInstructions = style === 'informative'
    ? "Provide detailed explanations. Teach the user why each optimization works. Include technical details when helpful."
    : "Be concise. Give direct answers without lengthy explanations. Only elaborate if explicitly asked.";

  return `${basePrompt}\n\n${styleInstructions}`;
};
```

## Verification

1. Open Settings → See Communication Style toggle
2. Select "Concise" → Explanations throughout app become shorter
3. Select "Informative" → Full explanations shown
4. Chat with Opta → Responses match selected style
5. Refresh app → Preference persists

## Files Modified

- `src/components/CommunicationStyleContext.tsx` (new)
- `src/pages/Settings.tsx`
- `src/components/LearnModeExplanation.tsx`
- `src/hooks/useChat.ts`
- `src/App.tsx`

## Estimated Duration

20-25 minutes
