# Opta Local Web — Guardrails

> Hard rules that must NEVER be violated. Read before writing code.

---

## Global Compliance (Inherited — Do Not Modify)

From `~/Synced/AI26/2-Bot-Ops/2A-Compliance/RULES-GLOBAL.md`:

- **C01:** No data exfiltration without approval
- **C02:** No destructive commands without "yes, delete"
- **C03:** No external posts/emails without approval
- **C04:** No modifying RULES-GLOBAL.md
- **C05:** No bypassing authentication
- **C06:** No executing untrusted code without review

## Credential Management

- **NEVER** hardcode API keys, admin keys, or tokens
- Admin keys stored encrypted in localStorage via `crypto.subtle`
- Use environment variables for build-time secrets only
- If a key is accidentally committed, rotate immediately

---

## Platform Rules

- **G-W01:** Next.js 16 + React 19 + TypeScript strict — no exceptions
- **G-W02:** Tailwind CSS + CSS variables only — no inline hex/rgb colors
- **G-W03:** Framer Motion for all animations — no CSS transitions for interactive elements
- **G-W04:** Lucide React for all icons — no other icon libraries
- **G-W05:** `/frontend-design` skill MUST be used for ALL UI component creation
- **G-W06:** No `any` types — use `unknown` + type narrowing
- **G-W07:** `cn()` helper for all conditional class merging
- **G-W08:** Dark mode only — no light theme support
- **G-W09:** No `axios`, `node-fetch`, or HTTP libraries — native `fetch` only
- **G-W10:** No CSS-in-JS (styled-components, emotion) — Tailwind only

## Performance Floors

- **G-P01:** First Contentful Paint <1.5 seconds
- **G-P02:** SSE connection established within 500ms of dashboard mount
- **G-P03:** No layout shift during streaming token append
- **G-P04:** First-load JS bundle <200KB gzipped
- **G-P05:** Streaming latency <100ms on LAN

## Architecture Rules

- **G-A01:** No intermediate backend — browser connects directly to LMX
- **G-A02:** All API calls through `LMXClient` abstraction — no raw fetch to LMX
- **G-A03:** Server Components by default — `'use client'` only when required
- **G-A04:** Error boundaries around every page-level component
- **G-A05:** SSE connections managed by hooks — never raw EventSource in components

## Anti-Features (Explicitly Rejected)

- **Never** add a light theme
- **Never** add cloud API proxying
- **Never** implement user authentication (single-user app)
- **Never** add an embedded code editor or IDE features
- **Never** make the web app require a backend server

## Testing Requirements

- All custom hooks must have unit tests
- LMX client must have integration tests (mock server)
- Critical UI flows (connect, chat, load model) must have E2E tests
- `npm run typecheck && npm run lint` must pass before any commit

---

*Violating these rules is a bug. If a guardrail needs changing, update this file and record in docs/DECISIONS.md.*

*Generated by OPIS v2.0 — 2026-02-18*
