# Opta-LMX Production Configuration — Mono512 (Mac Studio M3 Ultra, 512GB)
# Install to: ~/.opta-lmx/config.yaml on the Mac Studio

server:
  host: "0.0.0.0"          # LAN-accessible (192.168.188.11:1234)
  port: 1234
  workers: 1
  timeout_sec: 600          # 10 min — large models can be slow on first prompt

models:
  default_model: "mlx-community/MiniMax-M2.5-4bit"       # Set after first model download
  models_directory: "/Users/Shared/Opta-LMX/models"
  auto_load: []             # Add model IDs here to load on startup
  use_batching: true
  max_concurrent_requests: 4  # Prevents OOM from parallel requests on 512GB
  inference_timeout_sec: 600  # 10 min — matches server timeout for large generations
  warmup_on_load: true        # Prime JIT/Metal shaders on model load (2-3x faster first request)

memory:
  max_memory_percent: 85    # Conservative for 512GB — leaves ~77GB headroom for OS + apps
  auto_evict_lru: true

logging:
  level: "INFO"
  format: "structured"
  file: "/var/log/opta-lmx/opta-lmx.log"
  max_file_bytes: 52428800   # 50MB — rotates at this size
  backup_count: 5            # Keeps 5 backups (~250MB total max)

routing:
  default_model: "mlx-community/MiniMax-M2.5-4bit"       # Model for "auto" alias — set after first load
  aliases:
    # MiniMax M2.5 Team - Multi-quantity workflow
    code:
      - mlx-community/MiniMax-M2.5-5bit        # Heavy coding - best quality
      - lmstudio-community/MiniMax-M2.5-MLX-6bit
    reasoning:
      - mlx-community/MiniMax-M2.5-8bit        # Complex reasoning - highest quality
      - mlx-community/MiniMax-M2.5-6bit
    chat:
      - lmstudio-community/MiniMax-M2.5-MLX-4bit  # Fast, efficient chat
      - mlx-community/MiniMax-M2.5-5bit
    fast:
      - lmstudio-community/MiniMax-M2.5-MLX-4bit  # Quick responses
      - mlx-community/MiniMax-M2.5-4bit
    quality:
      - mlx-community/MiniMax-M2.5-5bit        # Best available quality
      - mlx-community/MiniMax-M2.5-6bit
      - mlx-community/MiniMax-M2.5-8bit

security:
  admin_key: null           # Set to a string for production admin auth
