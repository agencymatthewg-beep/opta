---
phase: 76-opta-text-reimplementation
plan: 02
type: execute
wave: 2
depends_on: ["76-01"]
files_modified:
  - opta-native/OptaApp/OptaApp/Views/Components/OptaTextView.swift
  - opta-native/OptaApp/OptaApp/Views/Components/OptaTextZone.swift
  - opta-native/OptaApp/OptaApp/Views/Dashboard/DashboardView.swift
autonomous: false
---

<objective>
Build the Opta branded text components and integrate them into the dashboard.

Purpose: Create the iconic "OPTA" text display and contextual messaging zone that define Opta's visual identity, then integrate them into the main dashboard view.

Output:
- OptaTextView.swift - The main branded "OPTA" text component with ring energy integration
- OptaTextZone.swift - Contextual messaging component with state-based styling
- Updated DashboardView with both components integrated
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Foundation from Plan 76-01:
@.planning/phases/76-opta-text-reimplementation/76-01-SUMMARY.md

# Existing components to integrate with:
@opta-native/OptaApp/OptaApp/Views/Dashboard/DashboardView.swift
@opta-native/OptaApp/OptaApp/Views/Components/QuickActions.swift
@opta-native/OptaApp/OptaApp/Bridge/OptaCoreManager.swift
@opta-native/OptaApp/OptaApp/Models/OptaViewModel.swift

# Reference implementation patterns from React:
# - OptaTextZone: state types (neutral, positive, warning, error), glow per state
# - CountUp animation for numeric values
# - TrendingUp/TrendingDown indicators
# - Ring energy (0-1) affects text glow intensity
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OptaTextView Component</name>
  <files>opta-native/OptaApp/OptaApp/Views/Components/OptaTextView.swift</files>
  <action>
Create the main branded "OPTA" text display component. Include:

1. **OptaTextStyle** enum:
   - `hero` - Large dashboard display (32pt, full animation)
   - `ambient` - Sidebar/secondary display (18pt, subtle)
   - `compact` - Menu bar/minimal display (12pt, no animation)

2. **OptaTextView** SwiftUI View:
   - Properties:
     - `style: OptaTextStyle = .hero`
     - `energyLevel: Double = 0.5` (0.0-1.0, from ring state)
   - Uses AnimatedTextView from 76-01 for character animation
   - Applies glow based on energy level:
     - energyLevel < 0.2: dormantViolet, minimal glow (intensity 0.2)
     - energyLevel 0.2-0.7: activeViolet, medium glow (intensity 0.5)
     - energyLevel > 0.7: glowPurple, strong glow (intensity 0.8)
   - Hero style: full ignition animation on appear
   - Ambient style: subtle fade-in only
   - Compact style: static, no animation

3. **Ring Energy Binding**:
   - Accept optional `@Binding var ringEnergy: Float?`
   - When bound, glow intensity animates with ring state changes
   - Use `.animation(.easeInOut(duration: 0.3))` for smooth transitions

4. **Preview Provider**:
   - Show all three styles
   - Show energy level variations (0.1, 0.5, 0.9)

Font choice: Use SF Pro (system font) with proper weights - it's Apple's native font and looks premium. Don't try to import Sora.
  </action>
  <verify>Build succeeds and preview renders: `cd opta-native/OptaApp && xcodebuild -scheme OptaApp -configuration Debug build 2>&1 | tail -20`</verify>
  <done>OptaTextView.swift exists with hero/ambient/compact styles, energy-reactive glow, and working previews.</done>
</task>

<task type="auto">
  <name>Task 2: Create OptaTextZone Component</name>
  <files>opta-native/OptaApp/OptaApp/Views/Components/OptaTextZone.swift</files>
  <action>
Create the contextual messaging component. Include:

1. **TextZoneState** enum:
   - `neutral` - Default, white/gray text, no glow
   - `positive` - Success, green tint, green glow
   - `warning` - Caution, amber tint, amber glow
   - `error` - Problem, red tint, red glow

2. **TextZoneMessage** struct:
   - `text: String`
   - `state: TextZoneState`
   - `value: Double?` (optional numeric to animate)
   - `trend: Trend?` (optional up/down indicator)
   - `Trend` enum: up, down, none

3. **CountUpText** View (internal):
   - Animates from 0 to target value over 1 second
   - Uses `@State private var displayValue: Double`
   - Timer-based interpolation for smooth counting
   - Formats with appropriate precision (0 decimals for %, 1 for others)

4. **TrendIndicator** View (internal):
   - Shows SF Symbol arrow (arrow.up / arrow.down)
   - Colored based on trend direction (green up, red down)
   - Subtle bounce animation on appear

5. **OptaTextZone** SwiftUI View:
   - Takes `message: TextZoneMessage`
   - Glass background with state-appropriate border color
   - Main text with glow effect based on state
   - Optional value display with CountUp animation
   - Optional trend indicator
   - Smooth transitions between messages using `.transition(.opacity)`

6. **Convenience Initializers**:
   - `OptaTextZone(text:)` - neutral message
   - `OptaTextZone.success(text:value:trend:)`
   - `OptaTextZone.warning(text:)`
   - `OptaTextZone.error(text:)`

Glass background: Use existing glass styling pattern from QuickActions.swift (Color(hex: "09090B") + .ultraThinMaterial).
  </action>
  <verify>Build succeeds: `cd opta-native/OptaApp && xcodebuild -scheme OptaApp -configuration Debug build 2>&1 | tail -20`</verify>
  <done>OptaTextZone.swift exists with all states, CountUp animation, trend indicators, and convenience initializers.</done>
</task>

<task type="auto">
  <name>Task 3: Integrate into DashboardView</name>
  <files>opta-native/OptaApp/OptaApp/Views/Dashboard/DashboardView.swift</files>
  <action>
Integrate OptaTextView and OptaTextZone into the dashboard. Changes:

1. **Add OptaTextView** at top of dashboard:
   - Position above the score display
   - Use `.hero` style
   - Bind energyLevel to ring state from viewModel (or use fixed 0.5 if ring state not available)

2. **Add OptaTextZone** below telemetry cards:
   - Show contextual system status message
   - Derive message from viewModel state:
     - If `thermalState == .critical`: error message about high temps
     - If `memoryPressure == .warning`: warning about memory
     - If `stealthModeActive`: positive message about optimization running
     - Default: neutral "System ready" message
   - Include relevant values (CPU %, memory %) when applicable

3. **Layout Adjustments**:
   - Ensure proper spacing between new components
   - Use VStack with consistent spacing (16-24pt)
   - OptaTextView should have prominent placement

4. **Animation Coordination**:
   - OptaTextView triggers ignition on dashboard appear
   - TextZone updates smoothly when system state changes

Do NOT remove existing dashboard content - add these components in addition to what's there.
  </action>
  <verify>Build succeeds: `cd opta-native/OptaApp && xcodebuild -scheme OptaApp -configuration Debug build 2>&1 | tail -20`</verify>
  <done>DashboardView includes OptaTextView at top with hero style, and OptaTextZone showing contextual system status.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
OptaTextView with animated "OPTA" branding and energy-reactive glow.
OptaTextZone with contextual messaging and state-based styling.
Dashboard integration with both components.
  </what-built>
  <how-to-verify>
1. Build and run the app: Open Xcode, select OptaApp scheme, press Cmd+R
2. On dashboard load, verify:
   - "OPTA" text appears at top with character-by-character animation
   - Text has purple glow effect
   - Glow intensity should be visible (medium brightness)
3. Check OptaTextZone below telemetry:
   - Shows system status message
   - Has glass background
   - Text color matches state (white for neutral)
4. Test state changes:
   - If possible, trigger thermal warning to see amber text zone
   - Verify smooth transitions between messages
5. Check different text sizes:
   - Hero style should be large and prominent
   - Text should be readable and properly styled
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any visual issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `xcodebuild -scheme OptaApp build` succeeds
- [ ] OptaTextView.swift has hero/ambient/compact styles
- [ ] OptaTextView energy-reactive glow works
- [ ] OptaTextZone.swift has all state types
- [ ] OptaTextZone CountUp animation works
- [ ] DashboardView shows OptaTextView at top
- [ ] DashboardView shows OptaTextZone with system status
- [ ] Visual verification approved by user
</verification>

<success_criteria>
- All tasks completed
- Build passes without errors
- Visual verification checkpoint passed
- "OPTA" text displays with ignition animation
- Text zone shows contextual system messages
- Glow effects visible and state-responsive
</success_criteria>

<output>
After completion, create `.planning/phases/76-opta-text-reimplementation/76-02-SUMMARY.md`
</output>
