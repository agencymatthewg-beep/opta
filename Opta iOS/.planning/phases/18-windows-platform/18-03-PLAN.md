---
phase: 18-windows-platform
plan: 03
type: execute
wave: 2
depends_on: ["18-01", "18-02"]
files_modified: []
autonomous: false
---

<objective>
Build Windows installer and verify all Windows-specific features work correctly on actual Windows hardware.

Purpose: Plans 18-01 and 18-02 can be developed on macOS, but Windows testing requires actual Windows. This plan coordinates the build and verification process.
Output: Verified Windows build with working installer and conflict detection.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/18-windows-platform/18-01-SUMMARY.md
@.planning/phases/18-windows-platform/18-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Windows installer via GitHub Actions</name>
  <files></files>
  <action>
Trigger Windows build via GitHub Actions:
1. Check if .github/workflows/build.yml exists and has Windows job
2. If CI exists: Push changes to trigger build, wait for artifact
3. If no CI: Document manual build steps for Windows machine

The build should produce:
- .msi installer (NSIS-generated)
- Portable .exe (optional)

If cross-compilation from macOS fails (expected), document that Windows build requires:
- Windows machine with Rust toolchain
- OR GitHub Actions with windows-latest runner
  </action>
  <verify>GitHub Actions shows Windows build job, or build steps documented</verify>
  <done>Windows build process established (CI or documented manual steps)</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Windows installer with NSIS customization and enhanced conflict detection:
- Custom install/uninstall hooks (from 18-01)
- Registry-based conflict scanning (from 18-02)
- Full Opta application
  </what-built>
  <how-to-verify>
On a Windows machine:

**Installer Testing:**
1. Download the .msi from GitHub Actions artifacts (or build locally)
2. Run installer - verify custom install dialog appears
3. Complete installation - verify Start Menu shortcut created
4. Check Settings > Apps - verify Opta appears in installed programs list

**Conflict Detection Testing:**
5. Launch Opta
6. Navigate to Settings page
7. Check Conflicts section - should show installed optimization tools
8. If you have GeForce Experience, Razer Cortex, or similar installed, verify they appear
9. Tools should show as "installed: true" even if not running

**Uninstaller Testing:**
10. Go to Settings > Apps > Opta > Uninstall
11. Verify uninstall dialog offers to export settings
12. Complete uninstall - verify app removed cleanly

**General Functionality:**
13. Verify telemetry works (CPU/GPU/RAM readings)
14. Verify process list shows Windows processes
15. Test Stealth Mode - verify Windows processes can be terminated
16. Test Chess feature - verify it works on Windows
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe specific issues found</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Windows build process established
- [ ] User verified installer on Windows
- [ ] User verified conflict detection on Windows
- [ ] User verified core Opta features on Windows
</verification>

<success_criteria>
- Windows build process works (CI or documented)
- Installer tested and approved on real Windows hardware
- Conflict detection verified with real Windows optimization tools
- Core functionality confirmed working on Windows
</success_criteria>

<output>
After completion, create `.planning/phases/18-windows-platform/18-03-SUMMARY.md`
</output>
