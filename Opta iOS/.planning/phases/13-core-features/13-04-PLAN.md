# Plan 13-04: Pinpoint Optimization Mode

wave: 2
autonomous: true

## Overview

Create wizard-style focused sessions for single optimization goals like "Maximize FPS in Valorant".

## Tasks

### 1. Create Pinpoint Optimization Page
**File**: `src/pages/PinpointOptimize.tsx` (new)

Multi-step wizard flow:

```tsx
type Step = 'select-goal' | 'select-game' | 'analyze' | 'review' | 'apply' | 'results';

export function PinpointOptimize() {
  const [step, setStep] = useState<Step>('select-goal');
  const [goal, setGoal] = useState<OptimizationGoal | null>(null);
  const [game, setGame] = useState<Game | null>(null);
  const [recommendations, setRecommendations] = useState<Recommendation[]>([]);

  return (
    <div className="max-w-2xl mx-auto py-8">
      <ProgressIndicator currentStep={step} />

      <AnimatePresence mode="wait">
        {step === 'select-goal' && (
          <GoalSelector onSelect={g => { setGoal(g); setStep('select-game'); }} />
        )}
        {step === 'select-game' && (
          <GameSelector goal={goal} onSelect={g => { setGame(g); setStep('analyze'); }} />
        )}
        {step === 'analyze' && (
          <AnalysisStep game={game} goal={goal} onComplete={recs => { setRecommendations(recs); setStep('review'); }} />
        )}
        {step === 'review' && (
          <ReviewStep recommendations={recommendations} onApprove={() => setStep('apply')} />
        )}
        {step === 'apply' && (
          <ApplyStep recommendations={recommendations} onComplete={() => setStep('results')} />
        )}
        {step === 'results' && (
          <ResultsStep game={game} goal={goal} />
        )}
      </AnimatePresence>
    </div>
  );
}
```

### 2. Create Goal Selector
**File**: `src/components/pinpoint/GoalSelector.tsx` (new)

```tsx
const OPTIMIZATION_GOALS = [
  { id: 'max-fps', label: 'Maximize FPS', icon: Zap, description: 'Get the highest possible frame rate' },
  { id: 'min-latency', label: 'Minimize Input Lag', icon: Timer, description: 'Reduce delay between input and action' },
  { id: 'reduce-heat', label: 'Reduce Heat', icon: Thermometer, description: 'Keep your system cooler and quieter' },
  { id: 'battery-life', label: 'Extend Battery', icon: Battery, description: 'Optimize for longer play sessions' },
];

export function GoalSelector({ onSelect }) {
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0, y: -20 }}
    >
      <h2 className="text-2xl font-bold mb-6">What do you want to optimize?</h2>
      <div className="grid grid-cols-2 gap-4">
        {OPTIMIZATION_GOALS.map(goal => (
          <motion.button
            key={goal.id}
            onClick={() => onSelect(goal)}
            className="glass rounded-xl p-6 text-left"
            whileHover={{ scale: 1.02, y: -2 }}
            whileTap={{ scale: 0.98 }}
          >
            <goal.icon className="w-8 h-8 text-primary mb-3" />
            <h3 className="font-semibold text-lg">{goal.label}</h3>
            <p className="text-sm text-muted-foreground">{goal.description}</p>
          </motion.button>
        ))}
      </div>
    </motion.div>
  );
}
```

### 3. Create Analysis Step
**File**: `src/components/pinpoint/AnalysisStep.tsx` (new)

Show analysis progress with predicted impact:

```tsx
export function AnalysisStep({ game, goal, onComplete }) {
  const [progress, setProgress] = useState(0);
  const [analyzing, setAnalyzing] = useState(true);

  useEffect(() => {
    const analyze = async () => {
      // Simulate analysis with progress
      for (let i = 0; i <= 100; i += 10) {
        await delay(200);
        setProgress(i);
      }

      // Get actual recommendations
      const recs = await getOptimizationRecommendations(game.id, goal.id);
      setAnalyzing(false);
      onComplete(recs);
    };
    analyze();
  }, [game, goal]);

  return (
    <motion.div className="text-center">
      <Loader2 className="w-12 h-12 text-primary animate-spin mx-auto mb-4" />
      <h2 className="text-xl font-semibold mb-2">
        Analyzing {game.name} for {goal.label}
      </h2>
      <Progress value={progress} className="w-64 mx-auto" />
      <p className="text-sm text-muted-foreground mt-2">
        Checking {progress < 30 ? 'game settings' : progress < 60 ? 'system config' : 'optimization potential'}...
      </p>
    </motion.div>
  );
}
```

### 4. Create Review Step with Impact Predictions
**File**: `src/components/pinpoint/ReviewStep.tsx` (new)

```tsx
export function ReviewStep({ recommendations, onApprove }) {
  const totalImpact = recommendations.reduce((sum, r) => sum + r.impactPercent, 0);

  return (
    <motion.div>
      <h2 className="text-2xl font-bold mb-2">Review Changes</h2>
      <p className="text-muted-foreground mb-6">
        Found {recommendations.length} optimizations with estimated {totalImpact}% improvement
      </p>

      <div className="space-y-3 mb-6">
        {recommendations.map((rec, i) => (
          <motion.div
            key={rec.id}
            className="glass-subtle rounded-lg p-4"
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: i * 0.1 }}
          >
            <div className="flex items-center justify-between">
              <div>
                <p className="font-medium">{rec.name}</p>
                <p className="text-sm text-muted-foreground">{rec.description}</p>
              </div>
              <Badge variant="outline" className="text-success border-success">
                +{rec.impactPercent}%
              </Badge>
            </div>
          </motion.div>
        ))}
      </div>

      <div className="flex gap-3">
        <Button variant="outline" className="flex-1">Skip All</Button>
        <Button className="flex-1" onClick={onApprove}>
          Apply All Changes
          <ArrowRight className="w-4 h-4 ml-2" />
        </Button>
      </div>
    </motion.div>
  );
}
```

### 5. Add Navigation Entry
**File**: `src/components/Sidebar.tsx`

Add Pinpoint to navigation:

```tsx
{
  id: 'pinpoint',
  label: 'Pinpoint',
  icon: Target,
  page: 'pinpoint' as const,
}
```

Update App.tsx to include the new page in routing.

## Verification

1. Click Pinpoint in sidebar → See goal selection
2. Select "Maximize FPS" → See game selection
3. Select a game → See analysis progress
4. Review recommendations → See impact predictions
5. Apply changes → See success results

## Files Modified

- `src/pages/PinpointOptimize.tsx` (new)
- `src/components/pinpoint/GoalSelector.tsx` (new)
- `src/components/pinpoint/GameSelector.tsx` (new)
- `src/components/pinpoint/AnalysisStep.tsx` (new)
- `src/components/pinpoint/ReviewStep.tsx` (new)
- `src/components/pinpoint/ApplyStep.tsx` (new)
- `src/components/pinpoint/ResultsStep.tsx` (new)
- `src/components/Sidebar.tsx`
- `src/App.tsx`

## Estimated Duration

35-40 minutes
