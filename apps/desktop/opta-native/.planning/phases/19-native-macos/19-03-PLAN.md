---
phase: 19-native-macos
plan: 03
type: execute
wave: 2
depends_on: ["19-01"]
files_modified: [OptaNative/Views/Components/, OptaNative/Utilities/DesignSystem.swift]
autonomous: false
---

<objective>
Create UI foundation with glass effects matching Opta's design system using native macOS vibrancy.

Purpose: Port Opta's distinctive glass aesthetic to native SwiftUI using NSVisualEffectView for stronger vibrancy than SwiftUI's built-in materials.
Output: Reusable glass components and design system constants.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-native-macos/19-RESEARCH.md
@.planning/phases/19-native-macos/19-01-SUMMARY.md
@DESIGN_SYSTEM.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create NSVisualEffectView bridge for glass effects</name>
  <files>OptaNative/Views/Components/GlassBackground.swift</files>
  <action>
Create GlassBackground using NSViewRepresentable to wrap NSVisualEffectView:

```swift
struct GlassBackground: NSViewRepresentable {
    var material: NSVisualEffectView.Material = .hudWindow
    var blendingMode: NSVisualEffectView.BlendingMode = .behindWindow
    var cornerRadius: CGFloat = 12

    func makeNSView(context: Context) -> NSVisualEffectView {
        let view = NSVisualEffectView()
        view.material = material
        view.blendingMode = blendingMode
        view.state = .active
        view.wantsLayer = true
        view.layer?.cornerRadius = cornerRadius
        return view
    }

    func updateNSView(_ nsView: NSVisualEffectView, context: Context) {
        nsView.material = material
    }
}
```

Create variants:
- GlassCard (rounded corners, subtle shadow)
- GlassPanel (full-width, no rounding)
- GlassButton (interactive states)

Use .hudWindow material for strongest glass effect matching Opta's aesthetic.
Do NOT use SwiftUI's built-in .ultraThinMaterial - it's weaker than NSVisualEffectView.
  </action>
  <verify>Build succeeds, GlassBackground renders in SwiftUI preview</verify>
  <done>Glass components render with proper vibrancy effect</done>
</task>

<task type="auto">
  <name>Task 2: Port design system colors and typography</name>
  <files>OptaNative/Utilities/DesignSystem.swift</files>
  <action>
Create DesignSystem.swift with Opta's design tokens ported to SwiftUI:

Colors (from DESIGN_SYSTEM.md):
- primary: purple-violet gradient base (#6366F1 / #8B5CF6)
- background: near-black (#09090B)
- card: slightly lighter (#18181B)
- border: subtle gray (#27272A at 30% opacity)
- success/warning/danger semantic colors

Typography:
- Use system font (SF Pro) - matches Sora's clean aesthetic
- Font weights: regular (400), medium (500), semibold (600)
- Size scale: xs(12), sm(14), base(16), lg(18), xl(20), 2xl(24)

Create as SwiftUI Color and Font extensions:
```swift
extension Color {
    static let optaPrimary = Color(hex: "#8B5CF6")
    static let optaBackground = Color(hex: "#09090B")
    static let optaCard = Color(hex: "#18181B")
    // etc.
}
```

Include LinearGradient for primary gradient effect.
  </action>
  <verify>Design system colors accessible via Color.optaPrimary etc.</verify>
  <done>Design system ported with all colors and typography</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Glass components with native macOS vibrancy matching Opta's design aesthetic</what-built>
  <how-to-verify>
    1. Run: Open project in Xcode, run app
    2. Create temporary test view using GlassCard with some content
    3. Compare: Glass effect should show desktop/windows behind with blur
    4. Verify: Vibrancy is strong (not washed out)
    5. Check: Colors match Opta's purple/violet primary
    6. Check: Dark background (#09090B) as base
  </how-to-verify>
  <resume-signal>Type "approved" if glass matches Opta aesthetic, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `xcodebuild -scheme OptaNative build` succeeds
- [ ] Glass components render with vibrancy
- [ ] Design system colors match DESIGN_SYSTEM.md values
- [ ] Visual verification passed by user
</verification>

<success_criteria>
- All tasks completed
- Glass effects match Opta's aesthetic (user verified)
- Design system provides consistent styling
- Components ready for MenuBar and MainWindow plans
</success_criteria>

<output>
After completion, create `.planning/phases/19-native-macos/19-03-SUMMARY.md`
</output>
