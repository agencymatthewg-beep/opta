---
phase: 07-game-detection
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified: [mcp-server/src/opta_mcp/game_settings.py, mcp-server/src/opta_mcp/server.py, src/types/games.ts]
autonomous: true
---

<objective>
Integrate community settings database for game-specific optimizations.

Purpose: Provide pre-configured optimal settings from community knowledge bases like PCGamingWiki.
Output: Settings database module with fallback recommendations.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Prior plan (game detection):
@.planning/phases/07-game-detection/07-01-PLAN.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create game settings database module</name>
  <files>mcp-server/src/opta_mcp/game_settings.py</files>
  <action>
Create `game_settings.py` with embedded optimization knowledge:

1. Define `GAME_OPTIMIZATIONS` database:
   ```python
   # Built-in optimization database
   # In future: fetch from community API or PCGamingWiki
   GAME_OPTIMIZATIONS = {
       # Steam app IDs as keys for common games
       "730": {  # CS2
           "name": "Counter-Strike 2",
           "settings": {
               "graphics": {
                   "shadows": "low",
                   "anti_aliasing": "off",
                   "texture_quality": "medium",
                   "vsync": "off"
               },
               "launch_options": "-novid -tickrate 128",
               "priority": "high"
           },
           "tips": [
               "Disable fullscreen optimizations",
               "Set Windows Game Mode on",
               "Close Discord overlay"
           ]
       },
       "570": {  # Dota 2
           "name": "Dota 2",
           "settings": {
               "graphics": {
                   "render_quality": "80%",
                   "shadows": "medium",
                   "ambient_occlusion": "off"
               },
               "launch_options": "-dx11",
               "priority": "high"
           },
           "tips": [
               "Enable Vulkan for AMD GPUs",
               "Disable Steam overlay"
           ]
       },
       "1245620": {  # Elden Ring
           "name": "Elden Ring",
           "settings": {
               "graphics": {
                   "quality_preset": "medium",
                   "ray_tracing": "off",
                   "motion_blur": "off"
               }
           },
           "tips": [
               "Cap framerate to 60 for stability",
               "Disable EAC overlay"
           ]
       }
   }
   ```

2. `get_game_settings(game_id: str) -> dict`:
   - Look up in GAME_OPTIMIZATIONS
   - Return settings if found, None if unknown
   - Include confidence level

3. `get_generic_optimization_tips() -> list`:
   - Return general tips for unknown games
   - "Close background apps", "Update GPU drivers", etc.

4. `generate_ai_recommendations(game_name: str, system_specs: dict) -> dict`:
   - Use LLM to generate settings for unknown games
   - Pass system specs for tailored recommendations
   - Mark as AI-generated (not community-verified)

Start with static database, expand to API integration later.
  </action>
  <verify>
cd mcp-server && uv run python -c "from opta_mcp.game_settings import get_game_settings; import json; print(json.dumps(get_game_settings('730'), indent=2))"
  </verify>
  <done>Game settings database returns optimization recommendations</done>
</task>

<task type="auto">
  <name>Task 2: Register MCP tools</name>
  <files>mcp-server/src/opta_mcp/server.py</files>
  <action>
Register game settings MCP tools:

1. `get_game_optimization` tool:
   - Input: game_id (string)
   - Output: settings, tips, source (database or AI)

2. `get_optimization_tips` tool:
   - Input: game_id (optional)
   - Output: tips list (game-specific or generic)

3. `ai_optimize_game` tool:
   - Input: game_name, system_specs
   - Output: AI-generated recommendations
   - Clearly marked as AI suggestions

Follow existing MCP tool patterns from server.py.
  </action>
  <verify>
cd mcp-server && uv run python -c "from opta_mcp.server import mcp; print('Game settings tools registered')"
  </verify>
  <done>MCP tools registered for game settings</done>
</task>

<task type="auto">
  <name>Task 3: Create Rust commands and TypeScript types</name>
  <files>src-tauri/src/games.rs, src/types/games.ts</files>
  <action>
1. Add to `games.rs`:
   ```rust
   #[derive(Debug, Serialize, Deserialize)]
   pub struct GameOptimization {
       pub name: String,
       pub settings: serde_json::Value,
       pub tips: Vec<String>,
       pub source: String,  // "database" or "ai"
   }

   #[tauri::command]
   pub async fn get_game_optimization(game_id: String) -> Result<Option<GameOptimization>, String> {
       call_mcp_tool("get_game_optimization", serde_json::json!({"game_id": game_id})).await
   }
   ```

2. Add to `src/types/games.ts`:
   ```typescript
   export interface GameOptimization {
     name: string;
     settings: Record<string, unknown>;
     tips: string[];
     source: "database" | "ai";
   }
   ```

3. Update `useGames.ts` hook:
   - Add `getOptimization(gameId: string)` function
   - Cache optimization data per game
   - Return source indicator for UI trust signals

Keep it read-only - settings application is Phase 8.
  </action>
  <verify>npm run build</verify>
  <done>TypeScript types ready for game optimization UI</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Settings database returns data for known games
- [ ] Generic tips returned for unknown games
- [ ] Rust commands compile
- [ ] `npm run build` succeeds
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Settings clearly indicate source (database vs AI)
</success_criteria>

<output>
After completion, create `.planning/phases/07-game-detection/07-02-SUMMARY.md`
</output>
