---
phase: 06.1-aesthetic-alignment
plan: 01
subsystem: design
tags: [typography, sora-font, moonlight-gradient, swiftui, design-tokens]

# Dependency graph
requires:
  - phase: 05-streaming-state
    provides: MessageBubble component, ChatView, design token foundation
provides:
  - Sora font bundle (5 weights: Light, Regular, Medium, SemiBold, Bold)
  - ClawdbotTypography.swift with Font.sora() extensions
  - MoonlightText gradient text view component
  - Letter-spacing tracking modifiers (trackingHero, trackingSubtitle, etc.)
  - Typography style modifiers (optaHeroStyle, optaSubtitleStyle, etc.)
  - LinearGradient.moonlight static property
affects: [06.1-02-glass, 06.1-03-animations, 06-rich-text]

# Tech tracking
tech-stack:
  added: [Sora font (OFL license), CoreText font registration]
  patterns: [em-to-pt tracking conversion, compound style modifiers]

key-files:
  created:
    - apps/ios/ClawdbotKit/Sources/ClawdbotKit/Resources/Fonts/Sora-*.ttf
    - apps/ios/ClawdbotKit/Sources/ClawdbotKit/Design/ClawdbotTypography.swift
    - apps/ios/ClawdbotKit/Tests/ClawdbotKitTests/ClawdbotTypographyTests.swift
  modified:
    - apps/ios/ClawdbotKit/Package.swift
    - apps/ios/ClawdbotKit/Sources/ClawdbotKit/Chat/MessageBubble.swift
    - apps/ios/ClawdbotKit/Sources/ClawdbotKit/Design/Design.swift

key-decisions:
  - "Use CTFontManagerRegisterGraphicsFont for runtime font registration"
  - "Map iOS pt sizes: Hero 34pt, SectionHeader 28pt, Subsection 20pt, Subtitle 17pt, Body 15pt, Caption 13pt, Badge 12pt"
  - "Calculate tracking as fontSize * emRatio (e.g., 34 * 0.12 = 4.08pt)"
  - "Moonlight gradient direction: top-to-bottom (180deg) mimicking overhead lighting"

patterns-established:
  - "Font.sora(size, weight) for custom Sora font instantiation"
  - "LinearGradient.moonlight for signature gradient"
  - "optaXxxStyle() compound modifiers combining font + tracking + color"
  - "trackingXxx(fontSize:) modifiers for em-equivalent letter-spacing"

issues-created: []

# Metrics
duration: 6min
completed: 2026-01-30
---

# Phase 06.1-01: Typography System Summary

**Sora font integrated with MoonlightText gradient view, tracking modifiers, and compound style modifiers matching Opta Typography Specification**

## Performance

- **Duration:** 6 min
- **Started:** 2026-01-30T08:23:31Z
- **Completed:** 2026-01-30T08:29:43Z
- **Tasks:** 8
- **Files modified:** 9

## Accomplishments

- Bundled Sora font (5 weights) into ClawdbotKit with Package.swift resource processing
- Created ClawdbotTypography.swift with font registration and Font.sora() extensions
- Implemented MoonlightText view with gradient fill (#fafafa -> #a855f7 -> #6366f1) and atmospheric glow
- Added tracking modifiers that convert CSS em values to SwiftUI tracking points
- Created compound optaXxxStyle() modifiers combining font, tracking, and color
- Updated MessageBubble to use Sora typography
- Added 16 typography unit tests (all passing)

## Task Commits

Each task was committed atomically:

1. **Task 1: Download and bundle Sora font files** - `ef1175e` (feat)
2. **Task 2: Create ClawdbotTypography with font registration** - `85d7132` (feat)
3. **Task 3: Implement MoonlightText gradient view** - `617c9f8` (feat)
4. **Task 4: Add letter-spacing tracking modifiers** - `487049d` (feat)
5. **Task 5: Create compound typography style modifiers** - `7a98ec2` (feat)
6. **Task 6: Update MessageBubble with Sora typography** - `6983b49` (feat)
7. **Task 7: Export typography from Design module** - `b03a764` (docs)
8. **Task 8: Add typography unit tests** - `cf32b4a` (test)

## Files Created/Modified

**Created:**
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Resources/Fonts/Sora-Light.ttf` - 300 weight
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Resources/Fonts/Sora-Regular.ttf` - 400 weight
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Resources/Fonts/Sora-Medium.ttf` - 500 weight
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Resources/Fonts/Sora-SemiBold.ttf` - 600 weight
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Resources/Fonts/Sora-Bold.ttf` - 700 weight
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Design/ClawdbotTypography.swift` - Typography system
- `apps/ios/ClawdbotKit/Tests/ClawdbotKitTests/ClawdbotTypographyTests.swift` - 16 tests

**Modified:**
- `apps/ios/ClawdbotKit/Package.swift` - Added resources directive for Fonts
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Chat/MessageBubble.swift` - Applied Sora fonts
- `apps/ios/ClawdbotKit/Sources/ClawdbotKit/Design/Design.swift` - Bumped version to 1.2.0

## Decisions Made

1. **Font registration approach**: Used CTFontManagerRegisterGraphicsFont for runtime registration rather than Info.plist (Swift Package doesn't support plist-based font registration)

2. **iOS point size mapping**: Converted web rem/px sizes to iOS pt using standard 16px=1rem baseline:
   - Hero: 56px -> 34pt (slightly smaller for mobile)
   - SectionHeader: 28px -> 28pt
   - Body: 16px -> 15pt (iOS standard)

3. **Tracking calculation**: CSS `letter-spacing: 0.12em` translates to `tracking = fontSize * 0.12` in SwiftUI points

4. **Gradient direction**: Used top-to-bottom (180deg) for MoonlightText, matching the specification's "mimicking overhead lighting" rationale

## Deviations from Plan

### Auto-fixed Issues

None - plan executed exactly as written.

### Deferred Enhancements

None.

---

**Total deviations:** 0
**Impact on plan:** None - executed as specified

## Issues Encountered

None - all tasks completed successfully.

## Next Phase Readiness

- Typography system complete, ready for glass effects integration (06.1-02)
- MoonlightText can be used in headers throughout the app
- MessageBubble now uses consistent Sora typography
- All 141 tests pass (16 new + 125 existing)

---
*Phase: 06.1-aesthetic-alignment*
*Completed: 2026-01-30*
