---
phase: 06.1-aesthetic-alignment
plan: 01
title: Typography System (Sora + Moonlight)
subsystem: design
wave: 1
autonomous: true
tags: [typography, sora-font, moonlight-gradient, swiftui, design-tokens]

# Dependency graph
requires:
  - phase: 05-streaming-state
    provides: MessageBubble component, ChatView, design token foundation
provides:
  - Sora font bundle integrated into ClawdbotKit
  - ClawdbotTypography.swift with Font extensions
  - MoonlightText gradient text view
  - Letter-spacing tracking modifiers
  - Typography style modifiers (.clawdbotHeroStyle, etc.)
affects: [06.1-02-glass, 06.1-03-animations, 06-rich-text]
---

# Phase 06.1-01: Typography System (Sora + Moonlight)

**Integrate Sora font into ClawdbotKit with Moonlight gradient text and letter-spacing presets matching the Opta Life Manager aesthetic**

## Objective

Replace SF Pro with Sora as the primary display font for ClawdbotKit. Implement MoonlightText view for gradient hero text. Add letter-spacing utilities matching the Opta typography specification.

## Execution Context

@.planning/phases/06.1-aesthetic-alignment/
@Sources/ClawdbotKit/Design/ClawdbotColors.swift
@/Users/matthewbyrden/Downloads/Actual Designs/Opta Typography — Official Font Specification.html

## Context

**Opta Typography Specification:**
- **Primary Font**: Sora (Google Fonts, OFL license)
- **Hero Heading**:
  - Size: 3.5rem (56px) / 34pt iOS
  - Weight: 700 (Bold)
  - Letter-spacing: 0.12em
  - Fill: Moonlight Gradient (linear-gradient 180deg, #fafafa 0%, #a855f7 50%, #6366f1 100%)
  - Text shadow: 0 0 80px rgba(139, 92, 246, 0.5)
- **Subtitle**:
  - Size: 1.1rem / 17pt iOS
  - Weight: 300 (Light)
  - Letter-spacing: 0.25em
  - Transform: uppercase
  - Color: #a1a1aa (textSecondary)
- **Section Header**:
  - Size: 1.75rem / 28pt iOS
  - Weight: 600 (SemiBold)
  - Letter-spacing: 0.08em

**Current ClawdbotKit state:**
- Uses SF Pro system font (no custom fonts)
- No gradient text implementation
- No letter-spacing modifiers
- Basic text styling in MessageBubble

## Tasks

### Task 1: Download and bundle Sora font files

1. Download Sora font from Google Fonts:
   - Sora-Light.ttf (300)
   - Sora-Regular.ttf (400)
   - Sora-Medium.ttf (500)
   - Sora-SemiBold.ttf (600)
   - Sora-Bold.ttf (700)

2. Create `Sources/ClawdbotKit/Resources/Fonts/` directory

3. Add font files to the directory

4. Update `Package.swift` to include font resources:
```swift
.target(
    name: "ClawdbotKit",
    dependencies: [],
    resources: [
        .process("Resources/Fonts")
    ]
)
```

**Commit after completion:** `feat(06.1-01): add Sora font bundle to ClawdbotKit`

### Task 2: Create ClawdbotTypography.swift with font registration

Create `Sources/ClawdbotKit/Design/ClawdbotTypography.swift`:

```swift
import SwiftUI

// MARK: - Font Registration

public enum ClawdbotTypography {
    /// Register custom fonts on app launch
    public static func registerFonts() {
        let fonts = ["Sora-Light", "Sora-Regular", "Sora-Medium", "Sora-SemiBold", "Sora-Bold"]
        for font in fonts {
            registerFont(named: font)
        }
    }

    private static func registerFont(named name: String) {
        guard let url = Bundle.module.url(forResource: name, withExtension: "ttf"),
              let provider = CGDataProvider(url: url as CFURL),
              let font = CGFont(provider) else {
            print("⚠️ ClawdbotKit: Failed to load font \(name)")
            return
        }
        CTFontManagerRegisterGraphicsFont(font, nil)
    }
}

// MARK: - Font Extensions

public extension Font {
    /// Sora font with specified size and weight
    static func sora(_ size: CGFloat, weight: Font.Weight = .regular) -> Font {
        let fontName: String
        switch weight {
        case .light: fontName = "Sora-Light"
        case .regular: fontName = "Sora-Regular"
        case .medium: fontName = "Sora-Medium"
        case .semibold: fontName = "Sora-SemiBold"
        case .bold: fontName = "Sora-Bold"
        default: fontName = "Sora-Regular"
        }
        return .custom(fontName, size: size)
    }

    /// Hero display font (34pt bold)
    static var soraHero: Font { .sora(34, weight: .bold) }

    /// Section header font (28pt semibold)
    static var soraSectionHeader: Font { .sora(28, weight: .semibold) }

    /// Subsection title font (20pt semibold)
    static var soraSubsection: Font { .sora(20, weight: .semibold) }

    /// Subtitle font (17pt light)
    static var soraSubtitle: Font { .sora(17, weight: .light) }

    /// Body font (15pt regular)
    static var soraBody: Font { .sora(15, weight: .regular) }

    /// Caption font (13pt regular)
    static var soraCaption: Font { .sora(13, weight: .regular) }

    /// Badge font (12pt regular)
    static var soraBadge: Font { .sora(12, weight: .regular) }
}
```

**Commit after completion:** `feat(06.1-01): create ClawdbotTypography with Sora font extensions`

### Task 3: Implement MoonlightText gradient view

Add to `ClawdbotTypography.swift`:

```swift
// MARK: - Moonlight Gradient Text

/// Gradient text view matching Opta Life Manager hero style
public struct MoonlightText: View {
    let text: String
    let size: CGFloat
    let weight: Font.Weight
    let tracking: CGFloat

    public init(
        _ text: String,
        size: CGFloat = 34,
        weight: Font.Weight = .bold,
        tracking: CGFloat = 0.12
    ) {
        self.text = text
        self.size = size
        self.weight = weight
        self.tracking = tracking
    }

    public var body: some View {
        Text(text)
            .font(.sora(size, weight: weight))
            .tracking(size * tracking)
            .foregroundStyle(moonlightGradient)
            .shadow(color: .clawdbotPurple.opacity(0.5), radius: 40, x: 0, y: 0)
    }

    private var moonlightGradient: LinearGradient {
        LinearGradient(
            colors: [
                Color(hex: "#fafafa"),
                Color(hex: "#a855f7"),
                Color(hex: "#6366f1")
            ],
            startPoint: .top,
            endPoint: .bottom
        )
    }
}

// MARK: - Moonlight Gradient Definition

public extension LinearGradient {
    /// The signature Opta moonlight gradient (white → violet → indigo)
    static var moonlight: LinearGradient {
        LinearGradient(
            colors: [
                Color(hex: "#fafafa"),
                Color(hex: "#a855f7"),
                Color(hex: "#6366f1")
            ],
            startPoint: .top,
            endPoint: .bottom
        )
    }
}

// MARK: - Color Hex Extension (if not already present)

extension Color {
    init(hex: String) {
        let hex = hex.trimmingCharacters(in: CharacterSet.alphanumerics.inverted)
        var int: UInt64 = 0
        Scanner(string: hex).scanHexInt64(&int)
        let a, r, g, b: UInt64
        switch hex.count {
        case 3: // RGB (12-bit)
            (a, r, g, b) = (255, (int >> 8) * 17, (int >> 4 & 0xF) * 17, (int & 0xF) * 17)
        case 6: // RGB (24-bit)
            (a, r, g, b) = (255, int >> 16, int >> 8 & 0xFF, int & 0xFF)
        case 8: // ARGB (32-bit)
            (a, r, g, b) = (int >> 24, int >> 16 & 0xFF, int >> 8 & 0xFF, int & 0xFF)
        default:
            (a, r, g, b) = (1, 1, 1, 0)
        }
        self.init(
            .sRGB,
            red: Double(r) / 255,
            green: Double(g) / 255,
            blue: Double(b) / 255,
            opacity: Double(a) / 255
        )
    }
}
```

**Commit after completion:** `feat(06.1-01): implement MoonlightText gradient view`

### Task 4: Add letter-spacing tracking modifiers

Add to `ClawdbotTypography.swift`:

```swift
// MARK: - Tracking Modifiers

public extension View {
    /// Hero tracking (0.12em equivalent)
    func trackingHero(fontSize: CGFloat = 34) -> some View {
        self.tracking(fontSize * 0.12)
    }

    /// Subtitle tracking (0.25em equivalent)
    func trackingSubtitle(fontSize: CGFloat = 17) -> some View {
        self.tracking(fontSize * 0.25)
    }

    /// Section header tracking (0.08em equivalent)
    func trackingSectionHeader(fontSize: CGFloat = 28) -> some View {
        self.tracking(fontSize * 0.08)
    }

    /// Badge tracking (0.15em equivalent)
    func trackingBadge(fontSize: CGFloat = 12) -> some View {
        self.tracking(fontSize * 0.15)
    }
}
```

**Commit after completion:** `feat(06.1-01): add letter-spacing tracking modifiers`

### Task 5: Create typography style modifiers

Add to `ClawdbotTypography.swift`:

```swift
// MARK: - Typography Style Modifiers

public extension View {
    /// Hero heading style - Sora bold with Moonlight gradient
    func clawdbotHeroStyle() -> some View {
        self
            .font(.soraHero)
            .trackingHero()
            .foregroundStyle(LinearGradient.moonlight)
            .shadow(color: .clawdbotPurple.opacity(0.5), radius: 40)
    }

    /// Subtitle style - Sora light, wide tracking, uppercase
    func clawdbotSubtitleStyle() -> some View {
        self
            .font(.soraSubtitle)
            .trackingSubtitle()
            .textCase(.uppercase)
            .foregroundColor(.clawdbotTextSecondary)
    }

    /// Section header style - Sora semibold with gradient
    func clawdbotSectionHeaderStyle() -> some View {
        self
            .font(.soraSectionHeader)
            .trackingSectionHeader()
            .foregroundStyle(
                LinearGradient(
                    colors: [.clawdbotTextPrimary, .clawdbotPurple],
                    startPoint: .leading,
                    endPoint: .trailing
                )
            )
    }

    /// Body text style - Sora regular
    func clawdbotBodyStyle() -> some View {
        self
            .font(.soraBody)
            .foregroundColor(.clawdbotTextPrimary)
    }

    /// Caption style - Sora caption, secondary color
    func clawdbotCaptionStyle() -> some View {
        self
            .font(.soraCaption)
            .foregroundColor(.clawdbotTextSecondary)
    }
}
```

**Commit after completion:** `feat(06.1-01): add typography style modifiers`

### Task 6: Update MessageBubble with Sora typography

Modify `Sources/ClawdbotKit/Chat/MessageBubble.swift`:

1. Apply Sora font to message content
2. Update timestamp styling
3. Update status label styling

```swift
// In MessageBubble body, update text styling:

// Message content
MarkdownContent(content: displayContent, textColor: textColor)
    .font(.soraBody)  // Add this

// Timestamp and status (if present)
Text(message.timestamp, style: .time)
    .font(.soraCaption)  // Update to Sora
    .foregroundColor(.clawdbotTextMuted)
```

**Commit after completion:** `feat(06.1-01): apply Sora typography to MessageBubble`

### Task 7: Export typography from Design module

Modify `Sources/ClawdbotKit/Design/Design.swift`:

```swift
// Add to exports
@_exported import struct ClawdbotKit.MoonlightText
```

Ensure `ClawdbotTypography.registerFonts()` is called:
- Add note in documentation
- Consider auto-registration on first use

**Commit after completion:** `feat(06.1-01): export typography from Design module`

### Task 8: Add typography unit tests

Create `Tests/ClawdbotKitTests/ClawdbotTypographyTests.swift`:

Test cases:
1. Sora font loads correctly for all weights
2. MoonlightText renders with correct gradient
3. Tracking modifiers apply correct spacing
4. Style modifiers apply combined styles
5. Font fallback works when Sora unavailable
6. Typography constants match specification

**Commit after completion:** `test(06.1-01): add typography unit tests`

## Verification

```bash
cd apps/ios/ClawdbotKit
swift build
swift test --filter Typography
```

Expected: Build succeeds, all tests pass

## Success Criteria

- [ ] Sora font files bundled in ClawdbotKit
- [ ] Font registration works on app launch
- [ ] MoonlightText displays gradient correctly
- [ ] Tracking modifiers apply correct letter-spacing
- [ ] Typography style modifiers work (.clawdbotHeroStyle, etc.)
- [ ] MessageBubble uses Sora font
- [ ] 6+ typography tests pass
- [ ] All existing 115+ tests still pass

## Output

Files created:
- `Sources/ClawdbotKit/Resources/Fonts/Sora-*.ttf` (5 files)
- `Sources/ClawdbotKit/Design/ClawdbotTypography.swift`
- `Tests/ClawdbotKitTests/ClawdbotTypographyTests.swift`

Files modified:
- `Package.swift` (add resources)
- `Sources/ClawdbotKit/Chat/MessageBubble.swift`
- `Sources/ClawdbotKit/Design/Design.swift`

---
*Phase: 06.1-aesthetic-alignment*
*Plan: 01 of 03*
*Wave: 1*
