---
phase: 43-settings-interaction-engine
plan: 05
type: execute
wave: 3
depends_on: ["43-02", "43-03", "43-04"]
files_modified: [.planning/research/knowledge/settings/solver/hardware-recommendations.json, .planning/research/knowledge/settings/solver/solver-rules.json]
autonomous: true
---

<objective>
Create the optimal setting combination solver data for Phase 47 integration.

Purpose: Build the data structure that Phase 47's Configuration Calculator will consume. This includes hardware-indexed recommendations and solver rules that combine conflicts, synergies, and trade-offs into actionable queries.

Output:
- `hardware-recommendations.json` - Optimal settings by hardware tier
- `solver-rules.json` - Rules for computing optimal combinations
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-settings-interaction-engine/43-CONTEXT.md
@.planning/research/knowledge/schema/settings-schema.json
@.planning/research/knowledge/settings/README.md
@.planning/research/knowledge/settings/conflicts/resolution-upscaling.json
@.planning/research/knowledge/settings/synergies/optimal-combinations.json
@.planning/research/knowledge/settings/tradeoffs/ray-tracing.json
@.planning/research/knowledge/settings/tradeoffs/apple-silicon.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create hardware-indexed recommendations</name>
  <files>.planning/research/knowledge/settings/solver/hardware-recommendations.json</files>
  <action>
Create a JSON file with optimal settings indexed by hardware tier.

**Hardware Tiers:**

1. **Entry Tier (M1, M2, 8GB):**
   - 1080p max resolution
   - Medium quality preset
   - No RT features
   - MetalFX recommended for higher res targets
   - 60fps target

2. **Mid Tier (M1 Pro, M2 Pro, M3, 16GB):**
   - 1440p native or 4K with MetalFX
   - High quality preset
   - Selective RT (reflections OR shadows)
   - 60fps target, 120fps for competitive

3. **High Tier (M3 Pro, M4 Pro, 18-36GB):**
   - 4K native possible
   - High/Ultra quality
   - Multiple RT features
   - 60-120fps depending on title

4. **Ultra Tier (M3 Max, M4 Max, Max Ultra, 48GB+):**
   - 4K Ultra everything
   - Full RT stack
   - 120fps at high settings
   - No compromises needed

**For each tier include:**
- `tier`: tier identifier
- `hardware`: array of matching hardware
- `defaultGoal`: typical optimization goal
- `recommendations`: object with settings by goal
  - `maxFps`: settings for maximum framerate
  - `balanced`: settings for balance
  - `quality`: settings for visual quality
  - `battery`: settings for battery life (portables only)
- `constraints`: what this tier cannot do
- `upgradeImpact`: what next tier unlocks

Target: 4 tier definitions with 4 goals each = 16+ recommendation sets.
  </action>
  <verify>cat .planning/research/knowledge/settings/solver/hardware-recommendations.json | python3 -c "import json,sys; d=json.load(sys.stdin); tiers=d.get('tiers', []); print(f'Valid JSON with {len(tiers)} hardware tiers')"</verify>
  <done>hardware-recommendations.json exists with 4 hardware tiers and goal-specific recommendations</done>
</task>

<task type="auto">
  <name>Task 2: Create solver rules</name>
  <files>.planning/research/knowledge/settings/solver/solver-rules.json</files>
  <action>
Create a JSON file with rules for Phase 47's Configuration Calculator.

**Solver Rule Categories:**

1. **Constraint Rules:**
   - `must_not_conflict`: settings pairs that cannot coexist
   - `must_satisfy_dependency`: if A then B required
   - `hardware_capability`: setting requires hardware feature
   - `memory_budget`: total VRAM must not exceed available

2. **Optimization Rules:**
   - `prefer_synergy`: when choosing between options, prefer synergistic pairs
   - `diminishing_returns`: beyond this value, gains are minimal
   - `bottleneck_detection`: if A is maxed and B has headroom, A limits
   - `balanced_quality`: related settings should be similar tier

3. **Goal-Specific Rules:**
   - `maxFps_priority`: disable expensive effects first
   - `quality_priority`: enable expensive effects last
   - `battery_priority`: reduce GPU/CPU load systematically
   - `competitive_priority`: minimize input lag above all

4. **Platform Rules:**
   - `macos_prefer_metalfx`: use MetalFX over DLSS/FSR when available
   - `macos_power_mode_aware`: adjust for battery vs plugged
   - `apple_silicon_uma`: account for shared memory
   - `windows_specific`: Windows-only optimizations

5. **Evaluation Rules:**
   - `impact_calculation`: how to sum impacts
   - `conflict_resolution`: how to handle conflicting recommendations
   - `uncertainty_handling`: when confidence is low

For each rule:
- `id`: rule identifier
- `type`: rule category
- `condition`: when rule applies (as evaluable expression)
- `action`: what to do
- `priority`: rule priority (1-10)
- `source`: which data files inform this rule

Target: 25-30 solver rules across all categories.
  </action>
  <verify>cat .planning/research/knowledge/settings/solver/solver-rules.json | python3 -c "import json,sys; d=json.load(sys.stdin); rules=d.get('rules', []); print(f'Valid JSON with {len(rules)} solver rules')"</verify>
  <done>solver-rules.json exists with 25+ solver rules</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] hardware-recommendations.json is valid JSON
- [ ] Contains 4 hardware tiers with goal-specific settings
- [ ] solver-rules.json is valid JSON
- [ ] Contains 25+ solver rules
- [ ] Rules cover constraints, optimization, goals, platforms
- [ ] Data format ready for Phase 47 consumption
</verification>

<success_criteria>
- All tasks completed
- Hardware recommendations cover entry â†’ ultra tiers
- Solver rules enable Phase 47 to compute optimal configs
- Integration point clear for Configuration Calculator
</success_criteria>

<output>
After completion, create `.planning/phases/43-settings-interaction-engine/43-05-SUMMARY.md`
</output>
